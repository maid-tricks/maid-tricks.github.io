{"version":3,"sources":["webpack:///../matrix-js-sdk/src/rust-crypto/RoomEncryptor.ts","webpack:///../matrix-js-sdk/src/rust-crypto/OutgoingRequestProcessor.ts","webpack:///../matrix-js-sdk/src/rust-crypto/KeyClaimManager.ts","webpack:///../matrix-js-sdk/src/rust-crypto/rust-crypto.ts","webpack:///../matrix-js-sdk/src/rust-crypto/index.ts"],"names":["RoomEncryptor","constructor","olmMachine","keyClaimManager","room","encryptionSettings","_defineProperty","this","prefixedLogger","logger","withPrefix","roomId","onCryptoEvent","config","JSON","stringify","error","onRoomMembership","member","debug","membership","userId","shouldEncryptForInvitedMembers","updateTrackedUsers","UserId","algorithm","Error","members","getEncryptionTargetMembers","map","u","userList","ensureSessionsForUsers","rustEncryptionSettings","EncryptionSettings","shareRoomKey","RoomId","event","ensureEncryptionSession","encryptedContent","encryptRoomEvent","getType","getContent","makeEncrypted","EventType","RoomMessageEncrypted","parse","identityKeys","curve25519","toBase64","ed25519","OutgoingRequestProcessor","http","msg","resp","KeysUploadRequest","rawJsonRequest","Method","Post","body","KeysQueryRequest","KeysClaimRequest","SignatureUploadRequest","KeysBackupRequest","Put","ToDeviceRequest","path","encodeURIComponent","event_type","txn_id","RoomMessageRequest","room_id","warn","Object","getPrototypeOf","id","markRequestAsSent","type","method","queryParams","opts","json","headers","prefix","response","authedRequest","info","e","KeyClaimManager","outgoingRequestProcessor","currentClaimPromise","Promise","resolve","stop","stopped","prom","finally","ensureSessionsForUsersInner","claimRequest","getMissingSessions","makeOutgoingRequest","RustCrypto","_userId","_deviceId","close","prepareToEncrypt","encryptor","roomEncryptors","_room","getRoomId","encryptEvent","res","decryptRoomEvent","event_id","getId","getWireType","sender","getSender","state_key","getStateKey","content","getWireContent","origin_server_ts","getTs","RustSdkCryptoJs","clearEvent","claimedEd25519Key","senderClaimedEd25519Key","senderCurve25519Key","forwardingCurve25519KeyChain","getEventEncryptionInfo","_event$getSenderKey","ret","senderKey","getSenderKey","undefined","encrypted","authenticated","mismatchedSender","checkUserTrust","UserTrustLevel","checkDeviceTrust","deviceId","DeviceTrustLevel","events","result","receiveSyncChanges","Map","Set","existingEncryptor","onSyncCompleted","syncState","outgoingRequestLoop","oldMembership","enc","outgoingRequestLoopRunning","outgoingRequests","length","async","initRustCrypto","Debug","turnOn","d","initialize","RUST_SDK_STORE_PREFIX","rustCrypto"],"mappings":"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","file":"bundles/4bf239dc7a34e5921e0d/37.js","sourceRoot":""}